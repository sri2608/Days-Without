<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Widget</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=DM+Sans:wght@300;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: #F7F4EF;
    color: #1A1A18;
    padding: 10px;
    overflow: hidden;
  }

  .widget-title {
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: #8A8780;
    margin-bottom: 8px;
    font-weight: 500;
  }

  .items { display: flex; flex-direction: column; gap: 6px; }

  .item {
    display: flex;
    align-items: center;
    gap: 8px;
    background: white;
    border-radius: 8px;
    padding: 6px 10px;
    border-left: 3px solid #4A7C59;
  }

  .num {
    font-family: 'DM Serif Display', serif;
    font-size: 1.4rem;
    line-height: 1;
    min-width: 32px;
    text-align: center;
  }

  .info { flex: 1; overflow: hidden; }

  .name {
    font-size: 0.72rem;
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .days-label {
    font-size: 0.6rem;
    color: #8A8780;
  }

  .empty {
    font-size: 0.8rem;
    color: #8A8780;
    text-align: center;
    padding: 1rem 0;
  }
</style>
</head>
<body>

<div class="widget-title">Days Without</div>
<div class="items" id="items"></div>

<script>
  const STORAGE_KEY = 'days-without-trackers';

  function load() {
    try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || []; }
    catch { return []; }
  }

  function daysSince(dateStr) {
    const diff = Date.now() - new Date(dateStr).getTime();
    return Math.floor(diff / (1000 * 60 * 60 * 24));
  }

  function render() {
    const data = load();
    const container = document.getElementById('items');

    if (data.length === 0) {
      container.innerHTML = `<div class="empty">No trackers yet.<br>Open the app to add some.</div>`;
      return;
    }

    // Show max 4 items in widget
    container.innerHTML = data.slice(0, 4).map(item => {
      const days = daysSince(item.since);
      return `
        <div class="item">
          <div class="num">${days}</div>
          <div class="info">
            <div class="name">Without ${item.name}</div>
            <div class="days-label">${days === 1 ? 'day' : 'days'}</div>
          </div>
        </div>
      `;
    }).join('');
  }

  render();
</script>
</body>
</html>
